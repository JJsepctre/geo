# ç»¼åˆç»“è®ºé¡µé¢ - åˆ—åˆå¹¶å±•å¼€æ–¹æ¡ˆ

## æ¦‚è¿°
é‡‡ç”¨å…¨æ–°çš„å®ç°æ–¹å¼ï¼Œå®Œå…¨ä¸ä½¿ç”¨Tableçš„`expandedRowRender`åŠŸèƒ½ï¼Œè€Œæ˜¯é€šè¿‡**åˆ—åˆå¹¶(colSpan)**æ¥å®ç°å±•å¼€æ•ˆæœï¼Œå½»åº•è§£å†³äº†å±•å¼€åˆ—é”™ä½çš„é—®é¢˜ã€‚

## âœ… æ–°æ–¹æ¡ˆä¼˜åŠ¿

### é—®é¢˜åˆ†æ
**æ—§æ–¹æ¡ˆé—®é¢˜**ï¼š
- ä½¿ç”¨Tableçš„`expandedRowRender`ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªå±•å¼€åˆ—
- å³ä½¿ç”¨CSSéšè—ï¼Œä¹Ÿä¼šå½±å“è¡¨æ ¼å¸ƒå±€
- å¯¼è‡´æ‰€æœ‰åˆ—é”™ä½

**æ–°æ–¹æ¡ˆä¼˜åŠ¿**ï¼š
- âœ… ä¸ä½¿ç”¨Tableçš„expandåŠŸèƒ½ï¼Œå®Œå…¨æ²¡æœ‰å±•å¼€åˆ—
- âœ… é€šè¿‡åŠ¨æ€æ’å…¥è¡Œå’Œåˆ—åˆå¹¶å®ç°å±•å¼€æ•ˆæœ
- âœ… è¡¨æ ¼å¸ƒå±€å®Œå…¨æ­£å¸¸ï¼Œä¸ä¼šé”™ä½
- âœ… æ›´çµæ´»ï¼Œå¯ä»¥è‡ªå®šä¹‰å±•å¼€å†…å®¹

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ•°æ®è½¬æ¢å‡½æ•°

```typescript
const getTableData = () => {
  const result: any[] = []
  mockData.forEach(record => {
    // å…ˆæ·»åŠ æ™®é€šæ•°æ®è¡Œ
    result.push(record)
    
    // å¦‚æœè¯¥è¡Œæ˜¯å±•å¼€çŠ¶æ€ï¼Œç´§æ¥ç€æ·»åŠ å±•å¼€è¡Œ
    if (expandedRowKey === record.id) {
      result.push({
        id: `${record.id}-expanded`,
        isExpandedRow: true,  // æ ‡è®°ä¸ºå±•å¼€è¡Œ
        parentRecord: record,
      })
    }
  })
  return result
}
```

**æ•°æ®ç»“æ„ç¤ºä¾‹**ï¼š
```javascript
[
  { id: '2185727', recordCode: '2185727', ... },  // æ™®é€šè¡Œ
  { id: '2185727-expanded', isExpandedRow: true, ... },  // å±•å¼€è¡Œ
  { id: '2185656', recordCode: '2185656', ... },  // æ™®é€šè¡Œ
  ...
]
```

### 2. åˆ—å®šä¹‰ - ä½¿ç”¨colSpan

æ¯ä¸ªåˆ—çš„renderå‡½æ•°éƒ½éœ€è¦å¤„ç†å±•å¼€è¡Œï¼š

```typescript
{
  title: 'åˆ†æ®µè®°å½•ç ',
  render: (_: any, record: any) => {
    if (record.isExpandedRow) {
      // å±•å¼€è¡Œï¼šè·¨è¶Šæ‰€æœ‰5åˆ—
      return {
        children: (
          // å±•å¼€å†…å®¹ï¼ˆå¤„ç½®æƒ…å†µè¡¨æ ¼ï¼‰
        ),
        props: {
          colSpan: 5,  // è·¨è¶Šæ‰€æœ‰åˆ—
        },
      }
    }
    // æ™®é€šè¡Œï¼šæ˜¾ç¤ºæ­£å¸¸æ•°æ®
    return record.recordCode
  },
}
```

```typescript
{
  title: 'å¤„ç½®ç±»å‹',
  render: (_: any, record: any) => {
    if (record.isExpandedRow) {
      // å±•å¼€è¡Œï¼šè¢«ç¬¬ä¸€åˆ—åˆå¹¶ï¼Œä¸æ˜¾ç¤º
      return {
        props: {
          colSpan: 0,  // è¢«åˆå¹¶ï¼Œä¸å ç”¨ç©ºé—´
        },
      }
    }
    return record.disposalType
  },
}
```

### 3. è¡¨æ ¼é…ç½®

```typescript
<Table
  columns={columns}
  data={getTableData()}  // ä½¿ç”¨è½¬æ¢åçš„æ•°æ®
  pagination={{ ... }}
  rowKey="id"
  border={{ wrapper: true, cell: true }}
  // ä¸éœ€è¦ expandedRowKeys
  // ä¸éœ€è¦ expandedRowRender
  // ä¸éœ€è¦ expandProps
/>
```

## ğŸ“Š è§†è§‰æ•ˆæœ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ†æ®µè®°å½•ç  | å¤„ç½®ç±»å‹ | åˆ›å»ºæ—¶é—´ | å¤„ç½®çŠ¶æ€ | æ“ä½œ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2185727 | ç»¼åˆç»“è®º | 2022-04-12 17:38:30 | å·²å¤„ç½® | æŸ¥çœ‹è¯¦æƒ… â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ <- å±•å¼€è¡Œ
â”‚ â”‚ å¤„ç½®æƒ…å†µ                                        â”‚ â”‚    (colSpan=5)
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ å¤„ç½®çŠ¶æ€ | åˆ›å»ºæ—¶é—´ | æ“ä½œ               â”‚   â”‚ â”‚
â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚ â”‚
â”‚ â”‚ â”‚         æš‚æ— æ•°æ®                          â”‚   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2185656 | ç»¼åˆç»“è®º | 2022-04-12 17:00:33 | å·²å¤„ç½® | æŸ¥çœ‹è¯¦æƒ… â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ äº¤äº’æµç¨‹

1. **åˆå§‹çŠ¶æ€**ï¼šè¡¨æ ¼æ˜¾ç¤º5æ¡æ™®é€šæ•°æ®
2. **ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"**ï¼š
   - `setExpandedRowKey(record.id)`
   - `getTableData()`é‡æ–°è®¡ç®—ï¼Œåœ¨è¯¥è¡Œåæ’å…¥å±•å¼€è¡Œ
   - è¡¨æ ¼é‡æ–°æ¸²æŸ“
3. **å±•å¼€è¡Œæ¸²æŸ“**ï¼š
   - ç¬¬ä¸€åˆ—ï¼šæ˜¾ç¤º"å¤„ç½®æƒ…å†µ"é¢æ¿ï¼ŒcolSpan=5
   - å…¶ä»–4åˆ—ï¼šcolSpan=0ï¼Œè¢«åˆå¹¶
4. **å†æ¬¡ç‚¹å‡»æˆ–ç‚¹å‡»å…¶ä»–è¡Œ**ï¼š
   - æ”¶èµ·å½“å‰å±•å¼€è¡Œ
   - å±•å¼€æ–°è¡Œï¼ˆå¦‚æœç‚¹å‡»çš„æ˜¯å…¶ä»–è¡Œï¼‰

## ğŸ” å…³é”®ä»£ç ç‰‡æ®µ

### å±•å¼€è¡Œå†…å®¹ï¼ˆç¬¬ä¸€åˆ—ï¼‰

```typescript
if (record.isExpandedRow) {
  return {
    children: (
      <div style={{ padding: '24px', background: '#f7f8fa' }}>
        <div style={{ fontSize: '16px', fontWeight: 600 }}>
          å¤„ç½®æƒ…å†µ
        </div>
        <Table
          columns={[...]}  // å¤„ç½®æƒ…å†µå­è¡¨æ ¼
          data={[]}
          pagination={false}
        />
      </div>
    ),
    props: {
      colSpan: 5,  // è·¨è¶Šæ‰€æœ‰5åˆ—
    },
  }
}
```

### å…¶ä»–åˆ—ï¼ˆè¢«åˆå¹¶ï¼‰

```typescript
if (record.isExpandedRow) {
  return {
    props: {
      colSpan: 0,  // ä¸æ˜¾ç¤ºï¼Œè¢«ç¬¬ä¸€åˆ—åˆå¹¶
    },
  }
}
```

## ğŸ“ ä¸æ—§æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆ(expandedRowRender) | æ–°æ–¹æ¡ˆ(colSpan) |
|------|---------------------------|-----------------|
| å±•å¼€åˆ— | è‡ªåŠ¨æ·»åŠ ï¼Œéš¾ä»¥éšè— | æ— å±•å¼€åˆ— |
| åˆ—å¯¹é½ | å®¹æ˜“é”™ä½ | å®Œå…¨å¯¹é½ |
| CSSä¾èµ– | éœ€è¦å¤æ‚CSSéšè— | ä¸éœ€è¦ç‰¹æ®ŠCSS |
| çµæ´»æ€§ | å—é™äºTable API | å®Œå…¨è‡ªå®šä¹‰ |
| æ€§èƒ½ | ä¸­ç­‰ | ç¨å¥½ï¼ˆæ•°æ®å˜åŒ–è§¦å‘é‡æ¸²æŸ“ï¼‰ |
| å®ç°å¤æ‚åº¦ | ç®€å• | ä¸­ç­‰ |

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. rowKeyå”¯ä¸€æ€§
ç¡®ä¿å±•å¼€è¡Œçš„IDå”¯ä¸€ï¼š
```typescript
id: `${record.id}-expanded`
```

### 2. colSpanæ•°é‡
colSpanè¦ç­‰äºæ€»åˆ—æ•°ï¼š
```typescript
colSpan: 5  // 5åˆ—è¡¨æ ¼
```

### 3. å…¶ä»–åˆ—è®¾ç½®
é™¤äº†ç¬¬ä¸€åˆ—ï¼Œå…¶ä»–åˆ—éƒ½è¦è®¾ç½®colSpan=0ï¼š
```typescript
if (record.isExpandedRow) {
  return { props: { colSpan: 0 } }
}
```

### 4. æ•°æ®æ›´æ–°
çŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°ï¼š
```typescript
data={getTableData()}  // æ¯æ¬¡renderéƒ½ä¼šé‡æ–°è®¡ç®—
```

## ğŸ¨ æ ·å¼è¯´æ˜

å±•å¼€è¡Œçš„æ ·å¼ï¼š
- **èƒŒæ™¯**ï¼š#f7f8faï¼ˆæµ…ç°ï¼‰
- **å†…è¾¹è·**ï¼š24px
- **åœ†è§’**ï¼š8px
- **å¤–è¾¹è·**ï¼š8px 0

å¤„ç½®æƒ…å†µå­è¡¨æ ¼ï¼š
- **èƒŒæ™¯**ï¼šç™½è‰²
- **æœ‰è¾¹æ¡†**
- **æ— åˆ†é¡µ**

## âœ… ä¼˜åŠ¿æ€»ç»“

1. **å®Œç¾å¯¹é½**ï¼šæ²¡æœ‰å±•å¼€åˆ—ï¼Œè¡¨æ ¼æ°¸è¿œä¸ä¼šé”™ä½
2. **å¹²å‡€ç®€æ´**ï¼šä¸éœ€è¦éšè—å…ƒç´ çš„CSS hack
3. **çµæ´»æ§åˆ¶**ï¼šå±•å¼€å†…å®¹å®Œå…¨è‡ªå®šä¹‰
4. **ç”¨æˆ·ä½“éªŒ**ï¼šç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ï¼Œå†…å®¹åœ¨è¡Œä¸‹æ–¹å±•å¼€
5. **ä»£ç æ¸…æ™°**ï¼šé€»è¾‘ç®€å•ï¼Œæ˜“äºç»´æŠ¤

## ğŸ”Œ åç»­æ‰©å±•

### æ·»åŠ å±•å¼€åŠ¨ç”»
å¯ä»¥ä½¿ç”¨CSS transitionï¼š
```css
.expanded-row-content {
  animation: slideDown 0.3s ease;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
```

### æ”¯æŒå¤šè¡ŒåŒæ—¶å±•å¼€
ä¿®æ”¹çŠ¶æ€ç®¡ç†ï¼š
```typescript
const [expandedRowKeys, setExpandedRowKeys] = useState<string[]>([])
```

### æ‡’åŠ è½½è¯¦æƒ…æ•°æ®
```typescript
const handleViewDetail = async (record: any) => {
  if (!detailDataMap[record.id]) {
    const data = await fetchDetailData(record.id)
    setDetailDataMap({ ...detailDataMap, [record.id]: data })
  }
  setExpandedRowKey(record.id)
}
```

ç°åœ¨çš„æ–¹æ¡ˆå½»åº•è§£å†³äº†è¡¨æ ¼é”™ä½é—®é¢˜ï¼

